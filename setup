#!/usr/bin/env bash

set -euo pipefail
shopt -s inherit_errexit

# Resolve script directory
if command -v realpath > /dev/null 2>&1; then
  SCRIPT_DIR=$(dirname "$(realpath "$0")")
else
  SCRIPT_DIR=$(cd -- "$(dirname -- "$0")" && pwd -P)
fi
source "${SCRIPT_DIR}/config.env"
readonly YEAR

# Ensure  env var is set

: "${YEAR:?Environment variable YEAR must be set}"

# 1. Create an empty videos.txt at root

# truncate to zero length or create if not exists
: > videos.txt

# 2. Names of the months

months=(January February March April May June July August September October November December)

# 3. Loop through each month and set up directories/files

for month in "${months[@]}"; do
  dir="./$month"
  mkdir -p "$dir"
  # Create header.md with the required content
  cat > "$dir/header.md" << EOF
  <!-- toc -->
  <!-- tocstop -->
  $month $YEAR

  RIAY $month $YEAR 
EOF

  echo "header.md" > "$dir/compact.txt"
done

echo "Setup complete: videos.txt plus folders and headers for each month for year $YEAR."
